$.fn.editable.defaults.mode="popup";var connection=jQuery.connection.boardHub;jQuery.connection.hub.start().done(function(){connection.server.join(document.title)});connection.client.renderPipeline=function(n,t,r,u){u.constructor.name.toLowerCase()==="string"&&(u=JSON.parse(u));var f='<tr><td class="'+(r==="True"?"pipeline-subscribed":"pipeline-unsubscribed")+'" data-pipeline="'+n+'">'+t+"<\/td>";for(i=0;i<u.length;i++)f+='<td class="dropArea" data-pipeline="'+n+'" data-stage="'+u[i]+'"><\/td>';$("#board").append(f+"<\/tr>");$("td.dropArea[data-pipeline="+n+"]").droppable({accept:"div.card",hoverClass:"cell-hover",drop:function(n,t){$(t.draggable).detach().css({top:0,left:0}).appendTo($(this))}})};connection.client.renderCard=function(n,t,i,r,u,f){f=f==="False"||f==="false"?!1:f;var e=$("div.card[data-card="+n+"]");e.length&&(f=f?f:$(e).find(".card-subscribed").length,e.remove());e='<div class="card" data-card="'+n+'" >  <div class="details">      <div class="id" title="'+r+'">ID: '+n+'          - <span data-type="text" data-pk="'+n+'" data-url="/Card/UpdateCardTitle" data-title="Enter title" class="x-editable" >'+r+"<\/span>      <\/div>"+(f?'<div class="card-subscription card-subscribed"><\/div>':'<div class="card-subscription card-unsubscribed"><\/div>')+'  <\/div>  <div class="content"  data-open="false">      <div class="data">            <span data-type="text" data-pk="'+n+'" data-url="/Card/UpdateCardDescription" data-title="Enter Description" class="x-editable">'+u+"<\/span>      <\/div>  <\/div><\/div>";$("td[data-pipeline="+t+"][data-stage="+i+"]").append(e);e=$("div.card[data-card="+n+"]");$(e).draggable({opacity:.5,scroll:!0,revert:"invalid",start:function(){connection.server.lockCard($(this).data("card"),document.title)},revert:function(n){var t=$(this);if(n)n.attr("id")==="recycle-bin"?jQuery.post("/Card/Remove",{id:t.data("card")},function(n){if(n.status=="success")connection.server.removeCard(t.data("card"),document.title);else return!0}).fail(function(){return!0}):(connection.server.move($(this).data("card"),$(this).parent().data("stage"),$(this).parent().data("pipeline"),document.title,username),connection.server.unlockCard($(this).data("card"),document.title));else return connection.server.unlockCard(t.data("card"),document.title),console.log("removing"),!0}});$(e).find(".x-editable").editable({success:function(n){if(n.status=="error")return n.message}});$(e).find(".x-editable").on("shown",function(){connection.server.lockCard(n,document.title)}).on("hidden",function(){connection.server.unlockCard(n,document.title)}).on("click",function(n){n.stopPropagation()})};connection.client.renderStage=function(n,t){$("#headers").append('<th data-stage="'+n+'" draggable="false" class="stage-unsubscribed">'+t+"<\/th>");$("tr:not(#headers)").each(function(){$(this).append('<td class="dropArea" data-pipeline="'+$(this).children(":last-child").data("pipeline")+'" data-stage="'+n+'"><\/td>')});$("td.dropArea[data-stage="+n+"]").droppable({accept:"div.card",hoverClass:"cell-hover",drop:function(n,t){$(t.draggable).detach().css({top:0,left:0}).appendTo($(this))}})};connection.client.removeCard=function(n){$("*[data-card="+n+"]").remove()};connection.client.lockCard=function(n){$("*[data-card='"+n+"']").css({opacity:"0.5","pointer-events":"none"})};connection.client.unlockCard=function(n){$("*[data-card='"+n+"']").css({opacity:"","pointer-events":""})};connection.client.moveCard=function(n,t,i){$("[data-stage='"+t+"'][data-pipeline='"+i+"']").append($("*[data-card='"+n+"']"))};connection.client.updateStatus=function(n){$("#status").text(n)};$(document).ready(function(){$("#create-new-board").on("click",function(){$("#create-board-modal").modal("show")});$("#new-board-name").focus(function(){($(this).val()==="Name cannot be empty."||$(this).val().substring(0,16)=="There is already")&&$(this).val("");$(this).removeClass("valid");$(this).removeClass("invalid")});$("#new-board-name").blur(function(){$("#new-board-name").val().trim().length>0&&$("#new-board-name").val().trim()!=""?jQuery.post("/Board/Validate",{name:$("#new-board-name").val().trim()},function(n){n.status=="false"?$("#new-board-name").addClass("valid"):($("#new-board-name").addClass("invalid"),$("#new-board-name").val('There is already a board called "'+$("#new-board-name").val().trim()+'"'))}):($("#new-board-name").addClass("invalid"),$("#new-board-name").val("Name cannot be empty."))});$("#save-new-board-button").on("click",function(){var n=!0;$("#new-board-name").val().trim().length>0==!1&&($("#new-board-name").addClass("invalid"),$("#new-board-name").val("Name cannot be empty."),n=!1);($("#new-board-name").val()=="Name cannot be empty."||$("#new-board-name").val().substring(0,16)=="There is already")&&(n=!1);$("#create-board-form .bootstrap-tagsinput").each(function(){$(this).children("span").length>0==!1&&($(this).addClass("invalid"),$(this).find("input:first").css("min-width","100%"),$(this).parent().find("input:first").attr("id")=="stages"?$(this).find("input:first").val("You need a minimum of 1 stage to get started."):$(this).find("input:first").val("You need a minimum of 1 pipeline to get started."),n=!1)});n&&jQuery.ajax({url:"/Board/Add",type:"POST",data:JSON.stringify({name:$("#new-board-name").val(),stages:$("#stages").tagsinput("items"),pipelines:$("#pipelines").tagsinput("items")}),dataType:"json",contentType:"application/json; charset=utf-8",success:function(n){n.status=="success"&&($("#create-board-modal").modal("hide"),$("#board-list li:last-child").before('<li class="list-group-item"><a href="/board/'+n.message+'">'+n.message+"<\/a><\/li>"));$("#new-board-name").val("");$("#new-board-name").removeClass("valid");$(".bootstrap-tagsinput").each(function(){$(this).removeClass("valid");$(this).find("> span").remove()})}})});$("form").on("submit",function(n){n.preventDefault();$(this).closest(".modal").find("button[data-role=form-submit]")[0].click()});$(document).on("click","#create-new-stage-button",function(){$("#create-stage-modal").modal("show")});$(document).on("click","#save-new-stage-button",function(){jQuery.post("/Stage/Add",$("#create-stage-form").serialize(),function(n){$("#create-stage-modal").modal("hide");connection.server.renderStage(n.stageId,n.name,document.title)}).fail(function(){alert("Something went wrong")}).always(function(){$("#create-stage-form")[0].reset()})});$(document).on("click","div.card > div.content",function(){$(this).data("open")===!1?($(this).find("div.data").slideDown(),$(this).data("open",!0)):($(this).find("div.data").slideUp(),$(this).data("open",!1))});$("#recycle-bin").droppable({accept:"div.card",tolerance:"touch",over:function(){$(this).children("i").css("color","red")},drop:function(){$(this).children("i").css("color","black")},out:function(){$(this).children("i").css("color","black")}});$(document).on("click","#create-new-card-button",function(){$("#create-card-modal").modal("show")});$(document).on("click","#save-new-card-button",function(){jQuery.post("/Card/Add",$("#create-card-form").serialize(),function(){$("#create-card-modal").modal("hide");$("#create-card-form")[0].reset()}).fail(function(){$("#create-card-modal").effect("shake")})});$(document).on("click","#create-new-pipeline-button",function(){$("#create-pipeline-modal").modal("show")});$(document).on("click","#save-new-pipeline-button",function(){jQuery.post("/Pipeline/Add",$("#create-pipeline-form").serialize(),function(){$("#create-pipeline-modal").modal("hide");$("#create-pipeline-form")[0].reset()}).fail(function(){$("#create-pipeline-modal").effect("shake")})});$(document).on("click","div.card div.details .card-subscription.card-subscribed",function(){jQuery.get("/Card/Unsubscribe/"+$(this).parent().parent().data("card"));$(this).removeClass("card-subscribed");$(this).addClass("card-unsubscribed")});$(document).on("click","div.card div.details .card-subscription.card-unsubscribed",function(){jQuery.get("/Card/Subscribe/"+$(this).parent().parent().data("card"));$(this).removeClass("card-unsubscribed");$(this).addClass("card-subscribed")});$(document).on("click","th.stage-subscribed",function(){jQuery.get("/Stage/Unsubscribe/"+$(this).data("stage"));$(this).removeClass("stage-subscribed");$(this).addClass("stage-unsubscribed")});$(document).on("click","th.stage-unsubscribed",function(){jQuery.get("/Stage/Subscribe/"+$(this).data("stage"));$(this).removeClass("stage-unsubscribed");$(this).addClass("stage-subscribed")});$(document).on("click","td.pipeline-subscribed",function(){jQuery.get("/Pipeline/Unsubscribe/"+$(this).data("pipeline"));$(this).removeClass("pipeline-subscribed");$(this).addClass("pipeline-unsubscribed")});$(document).on("click","td.pipeline-unsubscribed",function(){jQuery.get("/Pipeline/Subscribe/"+$(this).data("pipeline"));$(this).removeClass("pipeline-unsubscribed");$(this).addClass("pipeline-subscribed")})});
//# sourceMappingURL=pipelines.min.js.map